<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="629px" preserveAspectRatio="none" style="width:284px;height:629px;" version="1.1" viewBox="0 0 284 629" width="284px" zoomAndPan="magnify"><defs><filter height="300%" id="fg20ncuh4xynq" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="154" x="60.75" y="27.4023">&lt;预检请求时序图&gt;</text><rect fill="#FFFFFF" filter="url(#fg20ncuh4xynq)" height="394.5703" style="stroke: #000000; stroke-width: 2.0;" width="249.5" x="13" y="205.6191"/><rect fill="#FFFFFF" height="57.2656" style="stroke: none; stroke-width: 1.0;" width="249.5" x="13" y="222.9297"/><rect fill="#FFFFFF" height="57.2656" style="stroke: none; stroke-width: 1.0;" width="249.5" x="13" y="280.1953"/><rect fill="#FFFFFF" height="262.7285" style="stroke: none; stroke-width: 1.0;" width="249.5" x="13" y="337.4609"/><rect fill="#FFFFFF" filter="url(#fg20ncuh4xynq)" height="131.8418" style="stroke: #000000; stroke-width: 2.0;" width="122" x="23" y="461.3477"/><rect fill="#FFFFFF" height="57.2656" style="stroke: none; stroke-width: 1.0;" width="122" x="23" y="478.6582"/><rect fill="#FFFFFF" height="57.2656" style="stroke: none; stroke-width: 1.0;" width="122" x="23" y="535.9238"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="57" x2="57" y1="86.6875" y2="617.1895"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="228.5" x2="228.5" y1="86.6875" y2="617.1895"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="33.5" y="83.7344">浏览器</text><path d="M37,42.1992 L37,66.1992 M37,54.1992 L54,54.1992 " fill="none" filter="url(#fg20ncuh4xynq)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="66" cy="54.1992" fill="#FEFECE" filter="url(#fg20ncuh4xynq)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="204.5" y="83.7344">服务器</text><ellipse cx="228.5" cy="54.1992" fill="#FEFECE" filter="url(#fg20ncuh4xynq)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="216.5" x2="240.5" y1="68.1992" y2="68.1992"/><rect fill="#EEEEEE" filter="url(#fg20ncuh4xynq)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="269.5" x="3" y="117.3428"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="272.5" y1="117.3428" y2="117.3428"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="272.5" y1="120.3428" y2="120.3428"/><rect fill="#EEEEEE" filter="url(#fg20ncuh4xynq)" height="23.3105" style="stroke: #000000; stroke-width: 2.0;" width="113" x="81.25" y="106.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="99" x="87.25" y="123.2559">1. Options 请求</text><polygon fill="#A80036" points="216.5,157.3086,226.5,161.3086,216.5,165.3086,220.5,161.3086" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="57.5" x2="222.5" y1="161.3086" y2="161.3086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="64.5" y="156.5664">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="77.5" y="156.5664">自动发送 options 请求</text><polygon fill="#A80036" points="68.5,186.6191,58.5,190.6191,68.5,194.6191,64.5,190.6191" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="62.5" x2="227.5" y1="190.6191" y2="190.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="74.5" y="185.877">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="87.5" y="185.877">响应 options 请求</text><path d="M13,205.6191 L75,205.6191 L75,212.6191 L65,222.6191 L13,222.6191 L13,205.6191 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="394.5703" style="stroke: #000000; stroke-width: 2.0;" width="249.5" x="13" y="205.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="28" y="219.1875">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="90" y="218.2539">[浏览器判断 options 响应结果]</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="262.5" y1="223.9297" y2="223.9297"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124" x="18" y="234.5645">[响应不符合 CORS 协议]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="57.5" x2="99.5" y1="259.1953" y2="259.1953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="99.5" x2="99.5" y1="259.1953" y2="272.1953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="58.5" x2="99.5" y1="272.1953" y2="272.1953"/><polygon fill="#A80036" points="68.5,268.1953,58.5,272.1953,68.5,276.1953,64.5,272.1953" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="64.5" y="254.4531">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="77.5" y="254.4531">直接报错</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="262.5" y1="281.1953" y2="281.1953"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="140" x="18" y="291.8301">[实际请求不符合服务端限制]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="57.5" x2="99.5" y1="316.4609" y2="316.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="99.5" x2="99.5" y1="316.4609" y2="329.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="58.5" x2="99.5" y1="329.4609" y2="329.4609"/><polygon fill="#A80036" points="68.5,325.4609,58.5,329.4609,68.5,333.4609,64.5,329.4609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="64.5" y="311.7188">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="77.5" y="311.7188">直接报错</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="262.5" y1="338.4609" y2="338.4609"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="216" x="18" y="349.0957">[响应符合 cors 且实际请求符合服务端限制]</text><rect fill="#EEEEEE" filter="url(#fg20ncuh4xynq)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="269.5" x="3" y="373.0713"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="272.5" y1="373.0713" y2="373.0713"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="272.5" y1="376.0713" y2="376.0713"/><rect fill="#EEEEEE" filter="url(#fg20ncuh4xynq)" height="23.3105" style="stroke: #000000; stroke-width: 2.0;" width="82" x="96.75" y="362.416"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="102.75" y="378.9844">2. 实际请求</text><polygon fill="#A80036" points="216.5,413.0371,226.5,417.0371,216.5,421.0371,220.5,417.0371" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="57.5" x2="222.5" y1="417.0371" y2="417.0371"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="64.5" y="412.2949">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="77.5" y="412.2949">发送实际请求</text><polygon fill="#A80036" points="68.5,442.3477,58.5,446.3477,68.5,450.3477,64.5,446.3477" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="62.5" x2="227.5" y1="446.3477" y2="446.3477"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="74.5" y="441.6055">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="87.5" y="441.6055">响应请求</text><path d="M23,461.3477 L85,461.3477 L85,468.3477 L75,478.3477 L23,478.3477 L23,461.3477 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="131.8418" style="stroke: #000000; stroke-width: 2.0;" width="122" x="23" y="461.3477"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="38" y="474.916">alt</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="145" y1="479.6582" y2="479.6582"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="28" y="490.293">[响应不符合 cors 规则]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="57.5" x2="99.5" y1="514.9238" y2="514.9238"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="99.5" x2="99.5" y1="514.9238" y2="527.9238"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="58.5" x2="99.5" y1="527.9238" y2="527.9238"/><polygon fill="#A80036" points="68.5,523.9238,58.5,527.9238,68.5,531.9238,64.5,527.9238" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="64.5" y="510.1816">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="77.5" y="510.1816">直接报错</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="145" y1="536.9238" y2="536.9238"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="52" x="28" y="547.5586">[响应合法]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="57.5" x2="99.5" y1="572.1895" y2="572.1895"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="99.5" x2="99.5" y1="572.1895" y2="585.1895"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="58.5" x2="99.5" y1="585.1895" y2="585.1895"/><polygon fill="#A80036" points="68.5,581.1895,58.5,585.1895,68.5,589.1895,64.5,585.1895" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="64.5" y="567.4473">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="77.5" y="567.4473">处理请求</text><!--MD5=[c69bc6906cf768c724ffc5c7f5e9f52d]
@startuml
title <预检请求时序图>

hide footbox

boundary "浏览器" as c
entity "服务器" as s

==1. Options 请求==
autonumber
c->s: 自动发送 options 请求
s- ->c: 响应 options 请求

alt 浏览器判断 options 响应结果
else 响应不符合 CORS 协议
c -> c: 直接报错

else 实际请求不符合服务端限制
c -> c: 直接报错

else 响应符合 cors 且实际请求符合服务端限制

==2. 实际请求==
c->s: 发送实际请求
s- ->c: 响应请求
alt
else 响应不符合 cors 规则
c -> c: 直接报错

else 响应合法
c ->c: 处理请求
end
end
@enduml

PlantUML version 1.2020.09(Sun May 10 18:51:06 CST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 14.0.1+14
Operating System: Mac OS X
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>